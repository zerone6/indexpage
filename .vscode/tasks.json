{
  "version": "2.0.0",
  "tasks": [
    // ========================================
    // ì„œë¹„ìŠ¤ ì‹œì‘ (Start)
    // ========================================
    {
      "label": "1ï¸âƒ£ Start Other Services",
      "type": "shell",
      "command": "docker compose up -d main-page highschool",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      },
      "group": {
        "kind": "build",
        "isDefault": false
      }
    },
    {
      "label": "2ï¸âƒ£ Start Indexpage (Nginx)",
      "type": "shell",
      "command": "if docker compose ps main-page highschool 2>/dev/null | grep -q 'Up'; then docker compose up -d nginx-proxy; else echo 'âš ï¸  Backend services not running! Run \"1ï¸âƒ£ Start Other Services\" first.'; exit 1; fi",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      },
      "group": {
        "kind": "build",
        "isDefault": false
      }
    },
    {
      "label": "3ï¸âƒ£ Start Full Services",
      "type": "shell",
      "command": "docker compose up -d && echo '' && echo 'âœ… All services started!' && echo '' && docker compose ps",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      },
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },

    // ========================================
    // ì„œë¹„ìŠ¤ ì¤‘ì§€ (Stop)
    // ========================================
    {
      "label": "4ï¸âƒ£ Stop Indexpage (Nginx)",
      "type": "shell",
      "command": "docker compose stop nginx-proxy && echo 'âœ… Nginx stopped'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "5ï¸âƒ£ Stop Other Services",
      "type": "shell",
      "command": "docker compose stop main-page highschool && echo 'âœ… Other services stopped'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "6ï¸âƒ£ Stop Full Services",
      "type": "shell",
      "command": "docker compose down && echo 'âœ… All services stopped and removed'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },

    // ========================================
    // ê°œë°œ í¸ì˜ ê¸°ëŠ¥ (Development)
    // ========================================
    {
      "label": "7ï¸âƒ£ Reload Nginx Config",
      "type": "shell",
      "command": "docker compose exec nginx-proxy nginx -t && docker compose exec nginx-proxy nginx -s reload && echo 'âœ… Nginx config reloaded'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "8ï¸âƒ£ Rebuild and Restart Main-Page",
      "type": "shell",
      "command": "docker compose stop main-page && docker rmi main-page:latest 2>/dev/null || true && docker build --no-cache -t main-page:latest ./main-page && docker compose up -d main-page && echo '' && echo 'âœ… Main-page rebuilt (no cache) and restarted!' && docker compose logs --tail=20 main-page",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "9ï¸âƒ£ Rebuild and Restart Highschool",
      "type": "shell",
      "command": "docker compose build --no-cache highschool && docker compose up -d highschool && echo '' && echo 'âœ… Highschool rebuilt (no cache) and restarted!' && docker compose logs --tail=20 highschool",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },

    // ========================================
    // ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§ (Logs & Monitoring)
    // ========================================
    {
      "label": "ğŸ“‹ View All Logs",
      "type": "shell",
      "command": "docker compose logs -f",
      "isBackground": true,
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "ğŸ“‹ View Nginx Logs",
      "type": "shell",
      "command": "docker compose logs -f nginx-proxy",
      "isBackground": true,
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "ğŸ“‹ View Main-Page Logs",
      "type": "shell",
      "command": "docker compose logs -f main-page",
      "isBackground": true,
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "ğŸ“‹ View Highschool Logs",
      "type": "shell",
      "command": "docker compose logs -f highschool",
      "isBackground": true,
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "ğŸ“Š View Service Status",
      "type": "shell",
      "command": "clear && echo '=== Docker Compose Services ===' && docker compose ps && echo '' && echo '=== Resource Usage ===' && docker stats --no-stream",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": false
      }
    },

    // ========================================
    // í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ (Testing)
    // ========================================
    {
      "label": "ğŸ§ª Test Endpoints",
      "type": "shell",
      "command": "echo '=== Testing Endpoints ===' && echo '' && echo 'Main Page (HTTPS):' && curl -k -s https://localhost/ | grep -q 'ê°€ì¡± ì •ë³´' && echo 'âœ… OK' || echo 'âŒ FAIL' && echo '' && echo 'Highschool (HTTPS):' && curl -k -s https://localhost/highschool/ | head -c 100 && echo '' && echo '' && echo 'Health Check:' && curl -s http://localhost/health && echo ''",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "ğŸ§ª Test Nginx Config",
      "type": "shell",
      "command": "docker compose exec nginx-proxy nginx -t",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },

    // ========================================
    // ìœ í‹¸ë¦¬í‹° (Utilities)
    // ========================================
    {
      "label": "ğŸ”§ Clean Up Docker Resources",
      "type": "shell",
      "command": "echo 'âš ï¸  This will remove unused Docker resources...' && docker compose down && docker system prune -f && echo 'âœ… Cleanup complete'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "ğŸ”§ Rebuild All Images (No Cache)",
      "type": "shell",
      "command": "docker compose build --no-cache && echo 'âœ… All images rebuilt'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "ğŸŒ Open in Browser",
      "type": "shell",
      "command": "open https://localhost/",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "silent",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    },

    // ========================================
    // í”„ë¡œë•ì…˜ ëª¨ë“œ (Production Mode)
    // ========================================
    {
      "label": "ğŸš€ Start Production Mode (GHCR)",
      "type": "shell",
      "command": "docker compose -f docker-compose.yml pull && docker compose -f docker-compose.yml up -d && echo '' && echo 'âœ… Production mode started!' && docker compose ps",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "ğŸš€ Stop Production Mode",
      "type": "shell",
      "command": "docker compose -f docker-compose.yml down && echo 'âœ… Production mode stopped'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": false
      }
    }
  ]
}
